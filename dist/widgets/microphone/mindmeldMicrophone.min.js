"use strict";!function(n){function t(){s=new n.Listener({interimResults:!0,onResult:function(n,t,e,i){u.publishEvent("result",n,t,e,i)},onStart:function(n){u.publishEvent("start",n)},onEnd:function(n){u.publishEvent("end",n)},onError:function(n){u.publishEvent("error",n)}})}function e(){var n=r.querySelector(".volume-pulser");a=new window.VolumeMonitor({listener:s,onVolumeChange:function(t){var e=t/100*.5+1;n.style.transform="scale("+e+")"},onStop:function(){n.style.transform="scale(0.9)"},onError:function(n){u.publishEvent("error",n)}})}function i(){var n=null,t=1e3,e=r.querySelector(".icon-container");e.addEventListener("mousedown",function(){s.listening?u.stop():n=setTimeout(function(){u.start(!0),n=null},t)}),e.addEventListener("mouseup",function(){null!==n&&(clearTimeout(n),n=null,u.start())}),e.addEventListener("mouseout",function(){clearTimeout(n),n=null})}function o(){u.on("start",function(){r.classList.add("listening"),s.continuous&&r.classList.add("lock")}),u.on("end",function(){r.classList.remove("listening"),r.classList.remove("lock")})}var r,s,a,u=window.MindMeldMicrophone=window.MindMeldMicrophone||{};u.initialize=function(s){if(r=s,!n.support.speechRecognition){r.classList.add("disabled");var a="This browser does not support speech recognition";return void u.publishEvent("error",a)}t(),e(),i(),o(),u.publishEvent("init")},u.start=function(n){s.continuous=n,s.start(),a.start()},u.listening=function(){return s.listening},u.stop=function(){s.stop()};var l={};u.on=function(n,t,e){l[n]||(l[n]=[]);var i={callback:t,context:e};l[n].push(i)},u.publishEvent=function(n){var t=l[n];if(void 0!==t){var e=Array.prototype.slice.call(arguments,1);t.forEach(function(n){var t=n.context||this;n.callback.apply(t,e)})}}}(MM),function(){window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia;var n=window.AudioContext||window.webkitAudioContext,t=window.Uint8Array,e=function(n){this.listener=n.listener,this.onError=n.onError,this.onVolumeChange=n.onVolumeChange,this.onStop=n.onStop,this.stream=null,this.context=null,this.analyzer=null,this.frequencies=null,this.times=null,this.audioStarted=!1};e.prototype.start=function(){function e(n){s.stream=n;var t=s.context.createMediaStreamSource(n);t.connect(s.analyzer),i()}function i(){return s.listener.pending||s.listener.listening?(s.analyzer.getByteFrequencyData(s.frequencies),s.analyzer.getByteTimeDomainData(s.times),s.onVolumeChange&&s.onVolumeChange(o()),void window.setTimeout(i,75)):void s.stop()}function o(){return window.parseInt(r(0,s.analyzer.frequencyBinCount-1),10)}function r(n,t){for(var e=0,i=n;t>i;i++)e+=s.frequencies[i];return e/(t-n)}var s=this;this.audioStarted?i():(this.context=new n,this.analyzer=this.context.createAnalyser(),this.analyzer.smoothingTimeConstant=.18,this.analyzer.fftSize=256,this.frequencies=new t(this.analyzer.frequencyBinCount),this.times=new t(this.analyzer.frequencyBinCount),window.navigator.getUserMedia({audio:!0},e,function(n){s.onError("The following error occurred: "+n)}),this.audioStarted=!0)},e.prototype.stop=function(){this.onStop&&this.onStop(),this.stream&&this.stream.stop(),this.audioStarted=!1},window.VolumeMonitor=e}();
//# sourceMappingURL=mindMeldMicrophone.js
//# sourceMappingURL=mindMeldMicrophone.min.js.map