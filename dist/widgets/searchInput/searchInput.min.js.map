{"version":3,"sources":["searchInput.js"],"names":["containerElement","textElement","MindMeldSearchInput","window","initialize","element","querySelector","addEventListener","setFinal","e","keyCode","blur","text","getText","trim","setText","publishEvent","preventDefault","focus","console","log","isFinal","classList","remove","add","innerHTML","subscriptions","on","eventName","callback","context","subscription","push","subscribers","undefined","args","Array","prototype","slice","call","arguments","forEach","this","apply"],"mappings":"CAEE,WACA,YAEA,IAEIA,GACAC,EAHAC,EAAsBC,OAAOD,oBAAsBC,OAAOD,uBAW9DA,GAAoBE,WAAa,SAAqBC,GACpDL,EAAmBK,EACnBJ,EAAcD,EAAiBM,cAAc,yBAC7CL,EAAYM,iBAAiB,QAAS,WACpCL,EAAoBM,UAAS,KAG/BP,EAAYM,iBAAiB,WAAY,SAAUE,GAEjD,GAAIC,GAAUD,EAAEC,OAChB,IAAgB,KAAZA,EAAJ,CAKAT,EAAYU,MACZ,IAAIC,GAAOV,EAAoBW,UAAUC,MACzCZ,GAAoBa,QAAQH,GAAM,GAClCV,EAAoBc,aAAa,aAAcJ,GAE/CH,EAAEQ,oBAGJhB,EAAYM,iBAAiB,QAAS,WAEpCN,EAAYK,cAAc,QAAQY,UAGpClB,EAAiBM,cAAc,0BAA0BC,iBAAiB,QACxE,WACEY,QAAQC,IAAI,kBACZlB,EAAoBM,UAAS,EAC7B,IAAII,GAAOV,EAAoBW,UAAUC,MAGzC,OAFAZ,GAAoBc,aAAa,aAAcJ,IAExC,IAIXV,EAAoBc,aAAa,SAOnCd,EAAoBM,SAAW,SAAmBa,GAC5CA,EACFpB,EAAYqB,UAAUC,OAAO,WAE7BtB,EAAYqB,UAAUE,IAAI,YAO9BtB,EAAoBW,QAAU,WAC5B,MAAOZ,GAAYK,cAAc,QAAQmB,WAO3CvB,EAAoBa,QAAU,SAAkBH,EAAMS,GACpDnB,EAAoBM,SAASa,GAC7BpB,EAAYK,cAAc,QAAQmB,UAAYb,EAKhD,IAAIc,KAKJxB,GAAoByB,GAAK,SAAaC,EAAWC,EAAUC,GACnDJ,EAAcE,KAClBF,EAAcE,MAEhB,IAAIG,IACFF,SAAUA,EACVC,QAASA,EAEXJ,GAAcE,GAAWI,KAAKD,IAMhC7B,EAAoBc,aAAe,SAAuBY,GACxD,GAAIK,GAAcP,EAAcE,EAChC,IAAoBM,SAAhBD,EAA2B,CAC7B,GAAIE,GAAOC,MAAMC,UAAUC,MAAMC,KAAKC,UAAW,EACjDP,GAAYQ,QACV,SAAyBV,GACvB,GAAID,GAAUC,EAAaD,SAAWY,IACtCX,GAAaF,SAASc,MAAMb,EAAUK","file":"searchInput.min.js","sourcesContent":["/* exported MindMeldSearchInput */\n\n;(function searchInput () {\n  'use strict';\n\n  var MindMeldSearchInput = window.MindMeldSearchInput = window.MindMeldSearchInput || {};\n\n  var containerElement;\n  var textElement;\n\n\n  /**\n   * Initialize the search element.  Pass in the DOM (not jQuery) element\n   * that contains the search input.  In the provided html snippet, it would be\n   * `document.querySelector('.mindmeld-search')`.\n   */\n  MindMeldSearchInput.initialize = function initialize (element) {\n    containerElement = element;\n    textElement = containerElement.querySelector('.mindmeld-search-text');\n    textElement.addEventListener('focus', function() {\n      MindMeldSearchInput.setFinal(false);\n    });\n\n    textElement.addEventListener('keypress', function (e) {\n      // We are looking for CR (keyCode 13)\n      var keyCode = e.keyCode;\n      if (keyCode !== 13) {\n        return;\n      }\n\n      // User pressed return\n      textElement.blur();\n      var text = MindMeldSearchInput.getText().trim();\n      MindMeldSearchInput.setText(text, true);\n      MindMeldSearchInput.publishEvent('submitText', text);\n\n      e.preventDefault();\n    });\n\n    textElement.addEventListener('click', function (e) {\n      //We want to focus on the span inside.\n      textElement.querySelector('span').focus();\n    });\n    \n    containerElement.querySelector('.mindmeld-search-glass').addEventListener('click',\n      function (e) {\n        console.log('Clicking glass');\n        MindMeldSearchInput.setFinal(true);\n        var text = MindMeldSearchInput.getText().trim();\n        MindMeldSearchInput.publishEvent('submitText', text);\n\n        return false;\n      }\n    );\n\n    MindMeldSearchInput.publishEvent('init');\n  };\n\n  /**\n   * Set whether the search text is considered finalized or not.\n   * Non-final text is de-emphasized.\n   */\n  MindMeldSearchInput.setFinal = function setFinal (isFinal) {\n    if (isFinal) {\n      textElement.classList.remove('interim');\n    } else {\n      textElement.classList.add('interim');\n    }\n  };\n\n  /**\n   * Get the text of the search input.\n   */\n  MindMeldSearchInput.getText = function getText () {\n    return textElement.querySelector('span').innerHTML;\n  };\n\n  /**\n   * Sets the text of the search input. Use isFinal boolean to\n   * indicate whether the text is finalized or not\n   */\n  MindMeldSearchInput.setText = function setText (text, isFinal) {\n    MindMeldSearchInput.setFinal(isFinal);\n    textElement.querySelector('span').innerHTML = text;\n  };\n\n\n  // Event Dispatcher\n  var subscriptions = {};\n\n  /**\n  * Subscribe to search input events\n  */\n  MindMeldSearchInput.on = function on (eventName, callback, context) {\n    if (! subscriptions[eventName]) {\n      subscriptions[eventName] = [];\n    }\n    var subscription = {\n      callback: callback,\n      context: context\n    };\n    subscriptions[eventName].push(subscription);\n  };\n\n  /**\n  * Publish microphone events to subscribers\n  */\n  MindMeldSearchInput.publishEvent = function publishEvent (eventName /*, args...*/) {\n    var subscribers = subscriptions[eventName];\n    if (subscribers !== undefined) {\n      var args = Array.prototype.slice.call(arguments, 1);\n      subscribers.forEach(\n        function invokeCallback (subscription) {\n          var context = subscription.context || this;\n          subscription.callback.apply(context , args);\n        }\n      );\n    }\n  };\n}());\n"],"sourceRoot":"/source/"}